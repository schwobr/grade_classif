---

title: PytorchLightning Modules
keywords: fastai
sidebar: home_sidebar

summary: "Modules implementing <a>LightningModule</a> interface."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/20_models.plmodules.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseModule" class="doc_header"><code>class</code> <code>BaseModule</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L48" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseModule</code>(<strong><code>hparams</code></strong>, <strong><code>metrics</code></strong>=<em><code>None</code></em>) :: <code>LightningModule</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Base class for all classes implementing <code>LightningModule</code> interface. Defines a lot of convenience function to be used by children classes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BaseModule.load" class="doc_header"><code>BaseModule.load</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L158" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BaseModule.load</code>(<strong><code>version</code></strong>, <strong><code>ckpt_epoch</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Load a specific <code>version</code> of current model, stored in <code>self.save_path/lightning_logs</code>. If multiple
checkpoints have been stored, <code>ckpt_epoch</code> can be specified to load a specific epoch. Else the latest
epoch is loaded.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BaseModule.my_summarize" class="doc_header"><code>BaseModule.my_summarize</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L169" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BaseModule.my_summarize</code>()</p>
</blockquote>
<p>Get a DataFrame containing the list of all leaf modules of current model, with their corresponding output
shape.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BaseModule.fit" class="doc_header"><code>BaseModule.fit</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L177" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BaseModule.fit</code>()</p>
</blockquote>
<p>Fit the model using parameters stored in <a href="/params.parser.html#hparams"><code>hparams</code></a>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BaseModule.predict" class="doc_header"><code>BaseModule.predict</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L189" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BaseModule.predict</code>(<strong><code>x</code></strong>)</p>
</blockquote>
<p>Make a prediction on batch <code>x</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalizer" class="doc_header"><code>class</code> <code>Normalizer</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L208" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalizer</code>(<strong><code>hparams</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/models.plmodules.html#BaseModule"><code>BaseModule</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Module containing a UNet normalizer. Takes grayscale images as inputs and their corresponding colored version as outputs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Normalizer.show_results" class="doc_header"><code>Normalizer.show_results</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L233" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Normalizer.show_results</code>(<strong><code>n</code></strong>=<em><code>16</code></em>, <strong><code>imgsize</code></strong>=<em><code>4</code></em>, <strong><code>title</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot <code>n</code> predictions from the normalizer. Each line will contain input, target and prediction
images (in that order).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Normalizer.freeze_encoder" class="doc_header"><code>Normalizer.freeze_encoder</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L260" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Normalizer.freeze_encoder</code>()</p>
</blockquote>
<p>Freeze the encoder part of the normalizer.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Normalizer.init_bn" class="doc_header"><code>Normalizer.init_bn</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L269" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Normalizer.init_bn</code>()</p>
</blockquote>
<p>Initialize BatchNorm layers with bias <code>1e-3</code> and weights <code>1</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GradesClassifModel" class="doc_header"><code>class</code> <code>GradesClassifModel</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L280" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GradesClassifModel</code>(<strong><code>hparams</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/models.plmodules.html#BaseModule"><code>BaseModule</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Module containing a model used to make cancer grade classification. Model can either be a usual model defined in <code>timm</code>, a <a href="/models.modules.html#CBR"><code>CBR</code></a> (for Conv-BatchNorm-ReLU), a <a href="/models.modules.html#SASA"><code>SASA</code></a> (for Stand Alone Self-Attention) or a <a href="/models.modules.html#SANet"><code>SANet</code></a> (that mixes SASA and ResNet). All models heads are replaced by a GlobalAveragePool followed by two sequences of BatchNorm-Dropout-Linear layers. Dropout rate defined in <a href="/params.parser.html#hparams"><code>hparams</code></a> is halfed for the first sequence.</p>
<p>All important parameters are contained in <a href="/params.parser.html#hparams"><code>hparams</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RNNAttention" class="doc_header"><code>class</code> <code>RNNAttention</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L402" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RNNAttention</code>(<strong><code>hparams</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/models.plmodules.html#BaseModule"><code>BaseModule</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>RNN model with attention as defined in <a href="http://www.sfu.ca/~abentaie/papers/miccai18.pdf"><em>Predicting Cancer with a Recurrent Visual Attention Model for Histopathology Images</em></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RNNAttention.compute_loss" class="doc_header"><code>RNNAttention.compute_loss</code><a href="https://github.com/schwobr/grade_classif/tree/master/grade_classif/models/plmodules.py#L460" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RNNAttention.compute_loss</code>(<strong><code>X</code></strong>, <strong><code>Y</code></strong>)</p>
</blockquote>
<p>Compute the loss defined in the paper. Return the final slide-level prediction as well.</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

